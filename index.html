<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>Today’s Steel News</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href='https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css' rel='stylesheet' />
  <style>
    body, html {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
    }
    #header {
      width: 100%;
      padding: 10px;
      background: #333;
      color: #fff;
      text-align: center;
      font-size: 24px;
    }
    #container {
      display: flex;
      flex-direction: column;
      height: calc(100% - 50px); /* Adjusted for header height */
      overflow: hidden;
      position: relative;
    }
    #news-sections {
      padding: 10px;
      overflow-y: auto;
      flex: 1;
    }
    .section {
      margin-bottom: 20px;
    }
    .section-title {
      font-size: 18px;
      margin-bottom: 10px;
      color: #444;
    }
    .news-item {
      padding: 10px;
      border: 1px solid #ddd;
      background-color: #fff;
      margin-bottom: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .news-item:hover {
      background-color: #eee;
    }
    .news-content {
      display: none;
      padding: 10px;
      box-sizing: border-box;
      background-color: #ffffff;
    }
    .button {
      display: inline-block;
      padding: 5px 10px;
      margin-top: 10px;
      background-color: #333;
      color: #fff;
      text-align: center;
      cursor: pointer;
      border: none;
      border-radius: 5px;
    }
    #map {
      width: 100%;
      height: 300px;
      display: none;
    }
    #comment-section {
      margin-top: 20px;
    }
    #comment-form {
      display: flex;
      flex-direction: column;
    }
    #comment-form textarea {
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    #comment-form button {
      padding: 10px;
      background-color: #333;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #comments {
      margin-top: 20px;
    }
    .comment {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <div id="header">Today’s Steel News</div>
  <div id="container">
    <div id="news-sections">
      <div class="section" id="produce">
        <div class="section-title">Produce</div>
      </div>
      <div class="section" id="decarbonization">
        <div class="section-title">Decarbonization</div>
      </div>
      <div class="section" id="trade">
        <div class="section-title">Trade</div>
      </div>
      <div class="section" id="other">
        <div class="section-title">Other</div>
      </div>
    </div>
    <div id="map"></div>
    <div id="comment-section">
      <form id="comment-form">
        <textarea id="comment-text" rows="4" placeholder="Write your comment..."></textarea>
        <button type="submit">Submit</button>
      </form>
      <div id="comments"></div>
    </div>
  </div>

  <script src='https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js'></script>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiaGFydWNoYW5uIiwiYSI6ImNsdnFlZWRidTAyNmkya21yem1wMjhzZHUifQ.GrEXJlVvv0ljdkQXoEQTTQ';
    const map = new mapboxgl.Map({
      container: 'map', // container ID
      style: 'mapbox://styles/haruchann/clvqqksup01r901qpg3d0hynv', // style URL
      center: [31.261181743597245,30.033253480264698], // initial center coordinates
      zoom: 1.9, // initial zoom
      pitch: 0, // pitch in degrees
      bearing: 0 // bearing in degrees
    });

    map.addControl(new mapboxgl.NavigationControl());
    map.on('style.load', () => {
      map.setFog({}); // Set the default atmosphere style
    });

    const newsArticles = [
      {
        title: "Vietnam targets higher steel output, lower emissions",
        date: "05/13/2024",
        content: "Vietnam could produce 51 million tonnes of crude steel in 2050, Vietnam Steel Association (VSA) secretary general and vice chairman Dinh Quoc Thai said at Monday’s South East Asian Iron and Steel Institute (Seaisi) annual conference.",
        location: [105.8148158587074,21.01580842214596],
        category: "produce"
      },
      {
        title: "ArcelorMittal Restocking Outlook",
        date: "05/03/2024",
        content: "ArcelorMittal observes a waiting period for a rebound in restocking. Sentiment stabilizes, awaiting consumption increase due to low inventory levels. Maintains global steel demand growth forecast for 2024. Q1 shows declines in production, shipments, net profit, and Ebitda, but revenue grows compared to Q4 2023. European steel spreads improve, US prices stabilize influenced by low inventory. Challenges noted from China’s excess steel production and rising exports. Focus on upcoming projects for low-emission steel supply.",
        location: [6.143465193777926,49.62180385642374],
        category: "trade"
      }
    ];

    const sections = {
      produce: document.getElementById('produce'),
      decarbonization: document.getElementById('decarbonization'),
      trade: document.getElementById('trade'),
      other: document.getElementById('other')
    };

    newsArticles.forEach(article => {
      const newsItem = document.createElement('div');
      newsItem.className = 'news-item';
      newsItem.innerText = article.title;
      const contentDiv = document.createElement('div');
      contentDiv.className = 'news-content';
      contentDiv.innerHTML = `
        <p>${article.content}</p>
        <button class="button" onclick="zoomToImage(${article.location})">Detail Image</button>
        <button class="button" onclick="showFullContent('${article.content}')">Detail Content</button>
        <button class="button" onclick="showComments()">Comment</button>
      `;
      newsItem.appendChild(contentDiv);
      newsItem.addEventListener('click', () => {
        contentDiv.style.display = contentDiv.style.display === 'none' ? 'block' : 'none';
      });
      sections[article.category].appendChild(newsItem);
    });

    function zoomToImage(location) {
      map.flyTo({
        center: location,
        zoom: 15,
        essential: true
      });
      document.getElementById('map').style.display = 'block';
    }

    function showFullContent(content) {
      alert(content); // Change this to a more sophisticated modal if needed
    }

    function showComments() {
      document.getElementById('comment-section').scrollIntoView({ behavior: 'smooth' });
    }

    document.getElementById('comment-form').addEventListener('submit', function(event) {
      event.preventDefault();
      const commentText = document.getElementById('comment-text').value;
      if (commentText.trim() === '') return;
      const comment = document.createElement('div');
      comment.className = 'comment';
      comment.innerText = commentText;
      document.getElementById('comments').appendChild(comment);
      document.getElementById('comment-text').value = '';
    });
  </script>
</body>
</html>

