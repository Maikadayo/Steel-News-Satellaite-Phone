<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>Today’s Steel News</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href='https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.css' rel='stylesheet' />
  <style>
    body, html {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      background: rgba(0, 0, 0, 0.5) url('https://api.mapbox.com/styles/v1/mapbox/satellite-v9/static/0,0,1/800x600?access_token=pk.eyJ1IjoiaGFydWNoYW5uIiwiYSI6ImNsdnFlZWRidTAyNmkya21yem1wMjhzZHUifQ.GrEXJlVvv0ljdkQXoEQTTQ') no-repeat center center fixed;
      background-blend-mode: darken;
      background-size: cover;
    }
    #header, #footer {
      width: 100%;
      padding: 10px;
      background: #333;
      color: #fff;
      text-align: center;
      font-size: 15px;
    }
    #footer {
      position: fixed;
      bottom: 0;
    }
    #menu {
      width: 100%;
      padding: 10px 0;
      background: #555;
      color: #fff;
      text-align: center;
    }
    #menu a {
      margin: 0 10px;
      color: #fff;
      text-decoration: none;
    }
    #container {
      display: flex;
      flex-direction: column;
      height: calc(100% - 100px); /* Adjusted for header and footer height */
      overflow: hidden;
      position: relative;
    }
    #news-sections {
      padding: 10px;
      overflow-y: auto;
      flex: 1;
    }
    .section {
      margin-bottom: 20px;
    }
    .section-title {
      font-size: 18px;
      margin-bottom: 10px;
      color: #fff; /* Changed to white */
    }
    .news-item {
      padding: 10px;
      border: 1px solid #ddd;
      background-color: #fff;
      margin-bottom: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .news-item:hover {
      background-color: #eee;
    }
    .news-content-small {
      font-size: 12px;
      color: #666;
      display: block;
      margin-top: 5px;
    }
    .news-content {
      display: none;
      padding: 10px;
      box-sizing: border-box;
      background-color: #ffffff;
    }
    .button {
      display: inline-block;
      padding: 5px 10px;
      margin-top: 10px;
      background-color: #333;
      color: #fff;
      text-align: center;
      cursor: pointer;
      border: none;
      border-radius: 5px;
    }
    #map {
      width: 100%;
      height: 50%; /* Adjusted height to show map and content */
      display: none;
    }
    #satellite-content {
      padding: 10px;
      height: 50%; /* Adjusted height to show map and content */
      overflow-y: auto;
      display: none;
      background-color: #fff;
      box-sizing: border-box;
    }
    .comment-section {
      margin-top: 20px;
    }
    .comment-form {
      display: flex;
      flex-direction: column;
    }
    .comment-form input,
    .comment-form textarea {
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-family: 'Arial', sans-serif; /* Ensures same font-family */
    }
    .comment-form textarea {
      font-size: 14px; /* Same font-size as input */
    }
    .comment-form button {
      padding: 10px;
      background-color: #333;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .comments {
      margin-top: 10px;
      max-height: 100px; /* Make the comment section smaller */
      overflow-y: auto; /* Add scroll if comments overflow */
    }
    .comment {
      padding: 10px;
      border-bottom: 1px solid #ddd;
      font-size: 14px; /* Smaller font-size for comments */
    }
  </style>
</head>
<body>
  <div id="header">Today’s Steel News</div>
  <div id="menu">
    <a href="#" onclick="showSection('today')">Today's News</a>
    <a href="#" onclick="showSection('past')">Past News</a>
    <a href="#" onclick="showSection('satellite')">Satellite Image</a>
  </div>
  <div id="container">
    <div id="news-sections" data-section="today">
      <div class="section" id="production">
        <div class="section-title">Production</div>
      </div>
      <div class="section" id="decarbonization">
        <div class="section-title">Decarbonization</div>
      </div>
      <div class="section" id="trade">
        <div class="section-title">Trade</div>
      </div>
      <div class="section" id="other">
        <div class="section-title">Other</div>
      </div>
    </div>
    <div id="news-sections" data-section="past" style="display: none;">
      <div class="section-title">Past News</div>
      <!-- Past news will be dynamically populated here -->
    </div>
    <div id="map" data-section="satellite" style="display: none;"></div>
    <div id="satellite-content"></div> <!-- Added for content display -->
  </div>
  <div id="footer">© 2024 Steel News Satellite</div>

  <script src='https://api.mapbox.com/mapbox-gl-js/v3.3.0/mapbox-gl.js'></script>
  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiaGFydWNoYW5uIiwiYSI6ImNsdnFlZWRidTAyNmkya21yem1wMjhzZHUifQ.GrEXJlVvv0ljdkQXoEQTTQ';
    const map = new mapboxgl.Map({
      container: 'map', // container ID
      style: 'mapbox://styles/mapbox/satellite-v9', // style URL
      center: [31.261181743597245,30.033253480264698], // initial center coordinates
      zoom: 1.9, // initial zoom
      pitch: 0, // pitch in degrees
      bearing: 0 // bearing in degrees
    });

    map.addControl(new mapboxgl.NavigationControl());

    let isSpinning = true;

    map.on('style.load', () => {
      map.setFog({}); // Set the default atmosphere style
      spinGlobe();
    });

    let activeContentDiv = null;

    const newsArticles = [
      {
        title: "Nippon vice chairman resumes USS takeover promotion tour",
        date: "05/06/2024",
        content: "Nippon Steel's vice chairman Takahiro Mori is back in the US to advance the company's acquisition of US Steel, meeting with business leaders, politicians, and Pennsylvania community leaders. Compliance measures are being examined to close the deal, despite potential antitrust issues related to a facility Nippon co-owns with ArcelorMittal in Alabama; Mori is skeptical this will hinder the acquisition. Despite meetings with the United Steelworkers (USW), the union is not in favor of the acquisition; Mori believes the process will proceed more smoothly after the US presidential election.",
        location: [139.77690649345675,35.678302229785736],
        category: "other",
        copyOfNews: "Emirates Steel Arkan (ESA) has signed a memorandum of understanding with China’s Delong Steel Group for a new project to construct and operate a facility producing low-carbon emission raw materials for steelmaking, ESA chief executive Saeed Ghumran Al Remeithi says in a linkedin post. The ceo was part of the UAE delegation during the visit of UAE President Sheikh Mohamed bin Zayed Al Nahyan to China last week. ESA declined to provide further comment when contacted by Kallanish on Friday. The firm aims to increase its steelmaking capacity to 8 million tonnes/year and embark “on a massive international collaboration” to build a 15m t/y direct reduced iron hub in Abu Dhabi, chief project officer Hassan Shashaa said at the Danieli “Innovaction” Meeting in Udine last week (see separate story). The first phase of the project, to be announced in June, involves building a 7m t/y iron ore pelletising plant and a 2.5m t/y hot-briquetted iron facility, which will supply HBI to Japan. Emirates Steel signed an agreement to this purpose with Itochu Corporation and JFE Steel last year."
      },
      {
        title: "US rebar pricing weakens, sources blame borrowing costs",
        date: "05/06/2024",
        content: "US domestic rebar prices have dropped to $790-800/short ton from $790-810/short ton last week due to persistently high interest rates limiting bank approvals for nonresidential construction projects. Market participants report weak demand, high inventories, and aggressive pricing strategies by domestic mills contributing to the price decline. Private sector construction projects are inconsistent, and financing challenges are exacerbating the situation. The rebar market is also impacted by falling ferrous scrap prices, with an expected decline of $15-30/gross ton for June. Market sentiment suggests the rebar downtrend may persist through 2024, with potential improvement not anticipated until spring 2025.",
        location: [-77.04272846590575,38.92634689081075],
        category: "trade"
      },
      {
        title: "Low EU consumption discourages coil price increases",
        date: "05/06/2024",
        content: "European steelmakers are considering hot rolled coil (HRC) price increases, but weak demand across end-use sectors and service centers is causing hesitation. The European Commission's recent decision to impose a 15% cap per origin on the other country tariff-rate quota for HRC has generated mixed reactions, with some suppliers expecting price rises due to limited imports, while others fear a market standoff similar to February. The market for coil derivatives remains weak, with limited orders from the automotive and white goods sectors. Despite stable prices, service centers are struggling financially, and the new quota cap is expected to reduce availability from third countries, potentially impacting prices and supply stability in the near future.",
        location: [4.414872867967929,50.81434198352372],
        category: "trade"
      },
    ];

    const sections = {
      production: document.getElementById('production'),
      decarbonization: document.getElementById('decarbonization'),
      trade: document.getElementById('trade'),
      other: document.getElementById('other')
    };

    function loadComments() {
      const commentsData = JSON.parse(localStorage.getItem('commentsData')) || {};
      newsArticles.forEach(article => {
        const commentsSection = document.querySelector(`.comments[data-title="${article.title}"]`);
        if (commentsSection) {
          const articleComments = commentsData[article.title] || [];
          articleComments.forEach(comment => {
            const commentDiv = document.createElement('div');
            commentDiv.className = 'comment';
            commentDiv.innerHTML = `<strong>${comment.name}:</strong> ${comment.text}`;
            commentsSection.appendChild(commentDiv);
          });
        }
      });
    }

    function saveComment(title, name, text) {
      const commentsData = JSON.parse(localStorage.getItem('commentsData')) || {};
      if (!commentsData[title]) {
        commentsData[title] = [];
      }
      commentsData[title].push({ name, text });
      localStorage.setItem('commentsData', JSON.stringify(commentsData));
    }

    newsArticles.forEach(article => {
      const newsItem = document.createElement('div');
      newsItem.className = 'news-item';
      newsItem.innerHTML = `${article.title}<span class="news-content-small">${article.content}</span>`;
      const contentDiv = document.createElement('div');
      contentDiv.className = 'news-content';
      contentDiv.innerHTML = `
        <button class="button detail-image-btn" data-location='${JSON.stringify(article.location)}' data-content='${article.copyOfNews.replace(/'/g, "\\'")}'>Detail Image</button>
        <div class="comment-section">
          <h3>Comments</h3>
          <div class="comments" data-title="${article.title}"></div>
          <div class="comment-form">
            <input type="text" placeholder="Your name">
            <textarea placeholder="Your comment"></textarea>
            <button class="button submit-comment-btn" data-title="${article.title}">Submit</button>
          </div>
        </div>
      `;
      newsItem.appendChild(contentDiv);
      sections[article.category].appendChild(newsItem);
    });

    function showSection(section) {
      for (const key in sections) {
        if (key === section) {
          sections[key].style.display = 'block';
        } else {
          sections[key].style.display = 'none';
        }
      }
      if (section === 'satellite') {
        document.getElementById('map').style.display = 'block';
        document.getElementById('satellite-content').style.display = 'block';
        document.getElementById('satellite-content').innerHTML = '<p>Loading satellite data...</p>';
      } else {
        document.getElementById('map').style.display = 'none';
        document.getElementById('satellite-content').style.display = 'none';
      }
    }

    function spinGlobe() {
      map.rotateTo((map.getBearing() + 0.1) % 360, { duration: 100, easing: () => 0.1 });
      if (isSpinning) {
        requestAnimationFrame(spinGlobe);
      }
    }

    document.querySelectorAll('.news-item').forEach(item => {
      item.addEventListener('click', () => {
        const content = item.querySelector('.news-content');
        if (activeContentDiv && activeContentDiv !== content) {
          activeContentDiv.style.display = 'none';
        }
        if (content.style.display === 'block') {
          content.style.display = 'none';
          activeContentDiv = null;
        } else {
          content.style.display = 'block';
          activeContentDiv = content;
        }
      });
    });

    document.querySelectorAll('.submit-comment-btn').forEach(button => {
      button.addEventListener('click', () => {
        const title = button.getAttribute('data-title');
        const nameInput = button.parentElement.querySelector('input');
        const commentInput = button.parentElement.querySelector('textarea');
        const name = nameInput.value.trim();
        const text = commentInput.value.trim();
        if (name && text) {
          saveComment(title, name, text);
          const commentsSection = button.parentElement.parentElement.querySelector('.comments');
          const commentDiv = document.createElement('div');
          commentDiv.className = 'comment';
          commentDiv.innerHTML = `<strong>${name}:</strong> ${text}`;
          commentsSection.appendChild(commentDiv);
          nameInput.value = '';
          commentInput.value = '';
        } else {
          alert('Please enter your name and comment.');
        }
      });
    });

    document.querySelectorAll('.detail-image-btn').forEach(button => {
      button.addEventListener('click', () => {
        const location = JSON.parse(button.getAttribute('data-location'));
        const content = button.getAttribute('data-content');
        map.flyTo({
          center: location,
          zoom: 4,
          speed: 1.5,
          essential: true
        });
        document.getElementById('satellite-content').innerHTML = `<p>${content}</p>`;
      });
    });

    loadComments();
  </script>
</body>
</html>

